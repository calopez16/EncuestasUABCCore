@using EncuestasUABC.Enumerador;
@using EncuestasUABC.Utilidades;
@using EncuestasUABC.ViewModels;
@{UsuarioSessionInfoViewModel usuarioInfo = HttpContext.GetUsuarioInfoViewModel(); }


<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>@ViewData["Title"] - Encuestas UABC</title>

    <!-- Material Design -->
    <link rel="stylesheet" href="~/lib/material-design/css/material-design.css" />
    <link rel="stylesheet" href="~/lib/material-design/css/material-icons.css" />
    <!--Plugins Styles-->
    <link rel="stylesheet" href="~/lib/DataTables/datatables.bootstrap4.css" />
    <link rel="stylesheet" href="~/lib/selec2/css/select2.css" />


    <!--Site style-->
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="~/css/Menu.css" />

    <!--Jquery-->
    <script type="text/javascript" src="~/lib/jquery/jquery.js"></script>
    <script type="text/javascript" src="~/lib/selec2/js/select2.js"></script>
    <script type="text/javascript" src="~/lib/selec2/js/i18n/es.js"></script>

</head>
<body class="fixed-navbar">
    @{var url = HttpContext.HttpContext.Request.Scheme + "://" + HttpContext.HttpContext.Request.Host + HttpContext.HttpContext.Request.PathBase; }
    <script type="text/javascript">
            window.urlproyecto='@url';
    </script>
    <div class="loader-container">
        <div class="loader"></div>
    </div>

    <div class="d-flex" id="wrapper">
        <!-- Sidebar -->
        <div class="bg-light border-right" id="sidebar-wrapper">
            <div class="list-group list-group-flush">
                <div class="row">
                    <div class="col-12">
                        <h4 class="text-primary mt-2 text-center">
                            <img src="~/img/EncuestasUABCLogo.svg" style="width:40px" />
                            Encuestas UABC
                        </h4>
                        <hr />
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 text-center">
                        <span class="text-primary">@usuarioInfo.Rol</span>
                        <hr />
                    </div>
                    <div class="col-12">
                        <ul class="opciones">
                            <li>
                                <a asp-action="Perfil" asp-controller="Account" class="opciones-item btn btn-primary text-left p-3 pl-4 m-0">
                                    <i class="material-icons float-left clearfix">person</i>
                                    <span class="pl-3">Perfil</span>
                                </a>
                            </li>
                            @foreach (var permiso in usuarioInfo.PermisosMenu)
                            {
                                <li>
                                    @if (!permiso.PermisosHijos.Any())
                                    {

                                        <a class="opciones-item btn btn-primary text-left p-3 pl-4 m-0" href="@Url.Action(permiso.Action,permiso.Controller)">
                                            <i class="material-icons float-left">@permiso.Icono</i>
                                            <span class="pl-3" style="vertical-align:middle">@permiso.Descripcion</span>
                                        </a>
                                    }
                                    else
                                    {
                                        <a class="opciones-item btn btn-primary text-left p-3 pl-4">
                                            <i class="material-icons float-left">@permiso.Icono</i>
                                            <span class="pl-3">@permiso.Descripcion</span>
                                            <i class="material-icons float-right">keyboard_arrow_down</i>
                                        </a>
                                        <ul style="display:none">
                                            @foreach (var permisoHijo in permiso.PermisosHijos)
                                            {
                                                <li>
                                                    <a class="sub-opciones-item btn btn-secondary text-left p-3 pl-4" href="@Url.Action(permisoHijo.Action,permisoHijo.Controller)">
                                                        <i class="material-icons float-left">@permisoHijo.Icono</i>
                                                        <span class="pl-3">@permisoHijo.Descripcion</span>
                                                    </a>
                                                </li>
                                            }
                                        </ul>
                                    }
                                </li>
                            }
                        </ul>
                        <form asp-action="Logout" asp-controller="Account" id="form_Logout">
                        </form>
                    </div>
                    <div class="col-12">
                        <hr />
                        <ul class="opciones">
                            <li>
                                <a class="opciones-item btn btn-primary text-left p-3 pl-4 m-0" href="##" onclick="$('#form_Logout').submit()">
                                    <i class="material-icons float-left clearfix">exit_to_app</i>
                                    <span class="pl-3">Cerrar Sesión</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- Page Content -->
        <div id="page-content-wrapper">
            <nav class="navbar navbar-expand-lg navbar-light bg-primary border-bottom shadow-none">
                <div class="form-row w-100 d-flex justify-content-between">
                    <div class="col-2">
                        <button type="button" class="btn bmd-btn-fab float-left text-light" id="menu-toggle">
                            <i class="material-icons">menu</i>
                        </button>
                    </div>
                    <div class="col-8 d-flex justify-content-end">
                        <ul class="nav nav-pills">
                            <li class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle text-light" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                                    <i class="material-icons md-48 text-light float-left mr-3" style="margin-top:-15px">account_circle</i>
                                    @usuarioInfo.NombreCompleto
                                </a>
                                <div class="dropdown-menu dropdown-menu-right">
                                    <a asp-action="Perfil" asp-controller="Account" class="dropdown-item">
                                        <i class="material-icons float-left mr-2">person</i>
                                        Perfil
                                    </a>
                                    <a asp-action="Ayuda" asp-controller="Home" class="dropdown-item">
                                        <i class="material-icons float-left mr-2">support</i>
                                        Ayuda
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item" href="##" onclick="$('#form_Logout').submit()">
                                        <i class="material-icons float-left mr-2">exit_to_app</i>
                                        Cerrar Sesión
                                    </a>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
                    </ul>
                </div>
            </nav>

            <div class="container-fluid p-4">
                @RenderBody()
                <footer class="page-footer text-center text-md-left pt-4">
                    <!--Copyright-->
                    <div class="footer-copyright py-3 text-center">
                        <div class="container-fluid">
                            © @DateTime.Now.Year Copyright: Encuestas UABC
                        </div>
                    </div>
                    <!--/.Copyright-->
                </footer>
            </div>
        </div>
        <!-- /#page-content-wrapper -->
    </div>

    <script type="text/javascript" src="~/lib/jquery-ui/jquery-ui.min.js"></script>
    <script type="text/javascript" src="~/lib/DataTables/datatables.js"></script>
    <script type="text/javascript" src="~/lib/DataTables/datatables.bootstrap4.js"></script>
    <script type="text/javascript" src="~/lib/popper/umd/popper.js"></script>
    <script type="text/javascript" src="~/lib/material-design/js/material-design.js"></script>
    <script type="text/javascript" src="~/lib/bootstrap-notify/bootstrap-notify.js"></script>
    <script type="text/javascript" src="~/lib/cookiejs/cookiejs.js"></script>
    <script type="text/javascript" src="~/lib/jquery-validation/jquery.validate.min.js"></script>
    <script type="text/javascript" src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"></script>

    <!--JS Site-->
    <script type="text/javascript" src="~/js/site.js"></script>
    <script type="text/javascript" src="~/js/Menu.js"></script>

    <!--JS Material Design-->
    <script>$(document).ready(function () { $('body').bootstrapMaterialDesign(); });</script>

    <!--Vista de Alertas de la página-->
    <partial name="~/Views/Shared/_Alerts.cshtml" />
    <partial name="~/Views/Shared/_MensajesEstado.cshtml" />

    <!--Enumerador para obtener los tipos de alerta en toda la página-->
    <script type="text/javascript">
        var enum_MessageAlertType = @(EnumHelper.EnumToString<MessageAlertType>());
    </script>
    @RenderSection("Scripts", required: false)

</body>
</html>
